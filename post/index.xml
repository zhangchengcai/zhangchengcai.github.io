<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on My Life</title>
    <link>https://zhangchengcai.github.io/post/</link>
    <description>Recent content in Posts on My Life</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 09 May 2021 19:14:39 +0800</lastBuildDate>
    
	<atom:link href="https://zhangchengcai.github.io/post/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Spring整合mybatis</title>
      <link>https://zhangchengcai.github.io/post/spring%E6%95%B4%E5%90%88mybatis/</link>
      <pubDate>Sun, 09 May 2021 19:14:39 +0800</pubDate>
      
      <guid>https://zhangchengcai.github.io/post/spring%E6%95%B4%E5%90%88mybatis/</guid>
      <description>&lt;h1 id=&#34;回顾mybatis&#34;&gt;回顾mybatis&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/zhangchengcai/zcc-image-host/master/20210509/image-20210411102315490.51uzhxm0tf40.png&#34; alt=&#34;image-20210411102315490&#34;&gt;&lt;/p&gt;
&lt;p&gt;MyBatis的使用大致可分为以下三步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;使用MyBatis首先需要一个&lt;strong&gt;myBatis-config.xml&lt;/strong&gt; 的配置文件，或者config的java代码配置&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后需要通过SqlSessionFactoryBuild去build一个&lt;strong&gt;SqlSessionFactory&lt;/strong&gt;实例&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;最后通过SqlSessionFactory实例来创建&lt;strong&gt;SqlSession&lt;/strong&gt;实例。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中，在&lt;strong&gt;myBatis-config.xml&lt;/strong&gt;配置文件中主要配置有如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;properties（属性）&lt;/li&gt;
&lt;li&gt;settings（设置）&lt;/li&gt;
&lt;li&gt;typeAliases（类型别名）&lt;/li&gt;
&lt;li&gt;typeHandlers（类型处理器）&lt;/li&gt;
&lt;li&gt;objectFactory（对象工厂）&lt;/li&gt;
&lt;li&gt;plugins（插件）&lt;/li&gt;
&lt;li&gt;environments（环境配置）
&lt;ul&gt;
&lt;li&gt;environment（环境变量）
&lt;ul&gt;
&lt;li&gt;transactionManager（事务管理器）&lt;/li&gt;
&lt;li&gt;dataSource（数据源）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;databaseIdProvider（数据库厂商标识）&lt;/li&gt;
&lt;li&gt;mappers（映射器）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;配置详情可查看MyBatis官方文档。&lt;/p&gt;
&lt;p&gt;其中&lt;strong&gt;mappers&lt;/strong&gt;  配置项用来注册&lt;strong&gt;MyBatis的映射文件&lt;/strong&gt;。映射文件用于实现我们的dao接口与sql语句的绑定。&lt;/p&gt;
&lt;p&gt;配置完毕之后我们就可以通过SqlSession来获取相应的mapper去进行持久化操作了。&lt;/p&gt;
&lt;h1 id=&#34;spring整合mybatis&#34;&gt;spring整合mybatis&lt;/h1&gt;
&lt;p&gt;整合mybatis也就是我们需要将mybatis交给spring容器来托管。以xml方式配置spring为例：&lt;/p&gt;
&lt;h2 id=&#34;sqlsessionfactory&#34;&gt;SqlSessionFactory&lt;/h2&gt;
&lt;p&gt;首先我们要获取&lt;strong&gt;SqlSessionFactory&lt;/strong&gt;实例，在spring中，我们可通过&lt;code&gt;org.springframework.jdbc.datasource.DriverManagerDataSource&lt;/code&gt;创建&lt;strong&gt;SqlSessionFactory&lt;/strong&gt;实例，配置如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;bean&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;sqlSessionFactory&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;class=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;org.mybatis.spring.SqlSessionFactoryBean&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dataSource&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ref=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dataSource&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;configLocation&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;classpath:mybatis-config.xml&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mapperLocations&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;classpath:com/zcc/mapper/*.xml&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;dataSource&lt;/strong&gt;的配置根据你使用的数据源自行配置，下面实例使用spring内置的连接池进行配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;bean&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id =&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dataSource&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;class =&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;org.springframework.jdbc.datasource.DriverManagerDataSource&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;driverClassName&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${driver}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;url&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${url}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${user}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;value=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${password}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;当然我们并不需要将mybatis所有的配置项都在spring配置文件中完成（虽然spring可以做到这一点），通过使用&lt;strong&gt;configLocation&lt;/strong&gt;来为mybatis指定一个配置文件，在该文件中可以增加额外的mybatis配置项。&lt;/p&gt;
&lt;p&gt;使用&lt;strong&gt;mapperLocations&lt;/strong&gt;可以用来配置映射文件的位置。&lt;/p&gt;
&lt;p&gt;这样我们就可以通过spring来创建一个&lt;strong&gt;sqlSessionFactory&lt;/strong&gt;实例了。&lt;/p&gt;
&lt;h2 id=&#34;sqlsession&#34;&gt;SqlSession&lt;/h2&gt;
&lt;p&gt;接下来我们需要通过&lt;strong&gt;sqlSessionFactory&lt;/strong&gt;来创建&lt;strong&gt;sqlSession&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;在spring中我们可以通过&lt;code&gt;org.mybatis.spring.SqlSessionTemplate&lt;/code&gt;来获取&lt;strong&gt;sqlSession&lt;/strong&gt;。如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;bean&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;sqlSession&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;class=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;org.mybatis.spring.SqlSessionTemplate&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;constructor-arg&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ref=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;sqlSessionFactory&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;以上三项配置完之后就已经将spring与mybatis整合到了一起。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>